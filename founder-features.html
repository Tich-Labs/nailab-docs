<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nailab - Founder Features Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50" data-page-title="Founder Features">
    <div class="min-h-screen">
        <div id="nailabHeader"></div>
        <script src="shared.js"></script>
        <script>window.NailabShared.renderHeader();</script>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Overview Stats -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-8 animate-slide-in">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="flex justify-center mb-2">
                            <svg class="w-12 h-12 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 id="statCompletePercent" class="text-2xl font-bold text-green-600">95%</h3>
                        <p class="text-sm text-gray-600">Complete</p>
                    </div>
                    <div class="text-center">
                        <div class="flex justify-center mb-2">
                            <svg class="w-12 h-12 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 id="statInProgress" class="text-2xl font-bold text-yellow-600">10</h3>
                        <p class="text-sm text-gray-600">In Progress</p>
                    </div>
                    <div class="text-center">
                        <div class="flex justify-center mb-2">
                            <svg class="w-12 h-12 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                        </div>
                        <h3 id="statMissing" class="text-2xl font-bold text-red-600">4</h3>
                        <p class="text-sm text-gray-600">Missing</p>
                    </div>
                    <div class="text-center">
                        <div class="flex justify-center mb-2">
                            <svg class="w-12 h-12 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                            </svg>
                        </div>
                        <h3 id="statTotal" class="text-2xl font-bold text-blue-600">42</h3>
                        <p class="text-sm text-gray-600">Total Features</p>
                    </div>
                </div>
            </div>

            <!-- Legend -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
                <h3 class="text-lg font-semibold mb-4">Status Legend</h3>
                <p class="text-sm text-gray-600 mb-4">Tip: drag cards between columns (including back). Double-click a card to edit its title/description.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-green-500 rounded-full"></div>
                        <div>
                            <p class="font-medium">Complete ‚úÖ</p>
                            <p class="text-sm text-gray-600">Feature is fully implemented and functional</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-yellow-500 rounded-full"></div>
                        <div>
                            <p class="font-medium">Partial üü°</p>
                            <p class="text-sm text-gray-600">Feature exists but needs enhancements</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="w-4 h-4 bg-red-500 rounded-full"></div>
                        <div>
                            <p class="font-medium">Missing ‚ùå</p>
                            <p class="text-sm text-gray-600">Feature is not implemented</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kanban Board -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Completed Column -->
                <div class="bg-green-50 rounded-lg border border-green-200">
                    <div class="p-4 border-b border-green-200">
                        <h3 class="font-semibold text-green-800 flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            Completed (<span id="countComplete">28</span>)
                        </h3>
                    </div>
                    <div class="p-4 space-y-3 kanban-column" data-column="complete">
                        <!-- Authentication & Registration -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Founder Registration & Authentication</h4>
                            <p class="text-sm text-gray-600 mb-2">Email + password sign-up system for founders</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Password Reset</h4>
                            <p class="text-sm text-gray-600 mb-2">Forgot/Reset password functionality with validation</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Email Confirmation</h4>
                            <p class="text-sm text-gray-600 mb-2">Account activation via email confirmation</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <!-- Startup Profile Wizard -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Profile Wizard</h4>
                            <p class="text-sm text-gray-600 mb-2">Step-by-step profile completion with progress</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Personal Information</h4>
                            <p class="text-sm text-gray-600 mb-2">Founder photo, bio, location fields</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Startup Details</h4>
                            <p class="text-sm text-gray-600 mb-2">Name, logo, focus area, description, website</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Professional Background</h4>
                            <p class="text-sm text-gray-600 mb-2">Sector, stage, funding round fields</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Input Validation</h4>
                            <p class="text-sm text-gray-600 mb-2">Required fields validation</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Privacy Controls</h4>
                            <p class="text-sm text-gray-600 mb-2">Manage information visibility</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Save & Exit</h4>
                            <p class="text-sm text-gray-600 mb-2">Save progress during profile completion</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <!-- Dashboard -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Dashboard Access</h4>
                            <p class="text-sm text-gray-600 mb-2">Post-onboarding dashboard with welcome message</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Left Navigation</h4>
                            <p class="text-sm text-gray-600 mb-2">Complete navigation panel with all menu items</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Top Navigation Bar</h4>
                            <p class="text-sm text-gray-600 mb-2">Profile avatar and notification bell</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Welcome Banner</h4>
                            <p class="text-sm text-gray-600 mb-2">Personalized greeting message</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                        
                        <!-- Logout -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Logout Functionality</h4>
                            <p class="text-sm text-gray-600 mb-2">Secure sign-out with session termination</p>
                            <span class="status-badge bg-green-100 text-green-800">‚úÖ Complete</span>
                        </div>
                    </div>
                </div>

                <!-- In Progress Column -->
                <div class="bg-yellow-50 rounded-lg border border-yellow-200">
                    <div class="p-4 border-b border-yellow-200">
                        <h3 class="font-semibold text-yellow-800 flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            In Progress (<span id="countInProgress">10</span>)
                        </h3>
                    </div>
                    <div class="p-4 space-y-3 kanban-column" data-column="in_progress">
                        <!-- Dashboard Overview -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Profile Summary</h4>
                            <p class="text-sm text-gray-600 mb-2">View and edit startup profile data</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Account Settings</h4>
                            <p class="text-sm text-gray-600 mb-2">Update profile and change password</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Progress Tracking</h4>
                            <p class="text-sm text-gray-600 mb-2">View, add, edit milestones and metrics</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Monthly Progress Charts</h4>
                            <p class="text-sm text-gray-600 mb-2">Revenue, customers, runway, burn rate graphs</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <!-- Mentorship -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Recommended Mentors</h4>
                            <p class="text-sm text-gray-600 mb-2">Display mentors based on matching criteria</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">View Mentor Profiles</h4>
                            <p class="text-sm text-gray-600 mb-2">Display mentor information and expertise</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Session Booking</h4>
                            <p class="text-sm text-gray-600 mb-2">Calendar view, time slot selection, confirmation</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <!-- Community -->
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Recommended Founders</h4>
                            <p class="text-sm text-gray-600 mb-2">Display founders based on similarity</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Peer Messaging</h4>
                            <p class="text-sm text-gray-600 mb-2">Peer-to-peer communication system</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Resource Library</h4>
                            <p class="text-sm text-gray-600 mb-2">View, preview, download guides and templates</p>
                            <span class="status-badge bg-yellow-100 text-yellow-800">üü° Partial</span>
                        </div>
                    </div>
                </div>

                <!-- Missing Column -->
                <div class="bg-red-50 rounded-lg border border-red-200">
                    <div class="p-4 border-b border-red-200">
                        <h3 class="font-semibold text-red-800 flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                            Missing (<span id="countMissing">4</span>)
                        </h3>
                    </div>
                    <div class="p-4 space-y-3 kanban-column" data-column="missing">
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Account Deletion</h4>
                            <p class="text-sm text-gray-600 mb-2">Deactivate or delete account functionality</p>
                            <span class="status-badge bg-red-100 text-red-800">‚ùå Missing</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Calendar Integration</h4>
                            <p class="text-sm text-gray-600 mb-2">Google Calendar sync for mentorship sessions</p>
                            <span class="status-badge bg-red-100 text-red-800">‚ùå Missing</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">File Attachments</h4>
                            <p class="text-sm text-gray-600 mb-2">Upload business plans, pitch decks for applications</p>
                            <span class="status-badge bg-red-100 text-red-800">‚ùå Missing</span>
                        </div>
                        
                        <div class="feature-card bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-1">Advanced Search</h4>
                            <p class="text-sm text-gray-600 mb-2">Advanced filtering for mentors and opportunities</p>
                            <span class="status-badge bg-red-100 text-red-800">‚ùå Missing</span>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // Set last updated date (guard in case element is not present)
        const _lastUpdatedEl = document.getElementById('lastUpdated');
        if (_lastUpdatedEl) {
            _lastUpdatedEl.textContent = new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        // Kanban drag/drop + persistence
        document.addEventListener('DOMContentLoaded', function() {
            const STORAGE_KEY = 'nailab_founder_features_board_v2';
            const columns = Array.from(document.querySelectorAll('.kanban-column[data-column]'));
            const cards = Array.from(document.querySelectorAll('.feature-card'));
            let screenshotPaths = [];

            function ensureScreenshotDatalist() {
                let list = document.getElementById('screenshotOptions');
                if (list) return list;
                list = document.createElement('datalist');
                list.id = 'screenshotOptions';
                document.body.appendChild(list);
                return list;
            }

            function updateScreenshotDatalist() {
                const list = ensureScreenshotDatalist();
                list.innerHTML = '';
                screenshotPaths.forEach(p => {
                    const opt = document.createElement('option');
                    opt.value = p;
                    list.appendChild(opt);
                });
            }

            function normalize(str) {
                return (str || '').toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, ' ').trim();
            }

            function chooseFirstExisting(candidates) {
                for (const p of candidates) {
                    if (screenshotPaths.includes(p)) return p;
                }
                return null;
            }

            function suggestScreenshotForTitle(title) {
                const t = normalize(title);
                if (!t) return null;

                // Specific, high-confidence mappings
                if (t.includes('password reset') || t.includes('forgot password')) {
                    return chooseFirstExisting(['screenshots/site/auth/auth_password_new.png']);
                }
                if (t.includes('email confirmation') || t.includes('account activation') || t.includes('confirmation')) {
                    return chooseFirstExisting(['screenshots/site/auth/auth_confirmation_new.png']);
                }
                if (t.includes('sign in') || t.includes('login')) {
                    return chooseFirstExisting(['screenshots/site/auth/auth_sign_in.png']);
                }
                if (t.includes('registration') || t.includes('sign up') || t.includes('signup')) {
                    return chooseFirstExisting(['screenshots/site/auth/auth_sign_up.png']);
                }
                if (t.includes('account settings')) {
                    return chooseFirstExisting(['screenshots/founder/account_settings.png']);
                }
                if (t.includes('progress') && (t.includes('tracking') || t.includes('tracker'))) {
                    return chooseFirstExisting(['screenshots/founder/progress_tracker.png']);
                }
                if (t.includes('support')) {
                    return chooseFirstExisting(['screenshots/founder/support_center.png']);
                }
                if (t.includes('messaging') || t.includes('messages')) {
                    return chooseFirstExisting(['screenshots/founder/messages.png']);
                }
                if (t.includes('dashboard')) {
                    return chooseFirstExisting(['screenshots/founder/dashboard.png']);
                }
                if (t.includes('startup profile') || t.includes('startup details') || t.includes('profile wizard')) {
                    return chooseFirstExisting(['screenshots/founder/Startup_profile.png']);
                }

                // Fallback: best-effort filename match
                const tokens = t.split(' ').filter(Boolean);
                let best = null;
                let bestScore = 0;
                for (const p of screenshotPaths) {
                    const n = normalize(p);
                    let score = 0;
                    for (const tok of tokens) {
                        if (tok.length < 4) continue;
                        if (n.includes(tok)) score += 1;
                    }
                    if (score > bestScore) {
                        bestScore = score;
                        best = p;
                    }
                }
                return bestScore >= 2 ? best : null;
            }

            function formatDateTime(iso) {
                if (!iso) return '‚Äî';
                const d = new Date(iso);
                if (Number.isNaN(d.getTime())) return '‚Äî';
                return d.toLocaleString(undefined, {
                    year: 'numeric',
                    month: 'short',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            function ensureMetaRow(card) {
                let meta = card.querySelector('[data-meta-row]');
                if (meta) return meta;
                meta = document.createElement('div');
                meta.dataset.metaRow = '1';
                meta.className = 'mt-2 flex flex-wrap items-center gap-2 text-xs text-slate-500';
                meta.innerHTML = '<span data-created>Created: ‚Äî</span><span class="text-slate-300">‚Ä¢</span><span data-moved>Moved: ‚Äî</span>';
                card.appendChild(meta);
                return meta;
            }

                        function ensureScreenshotSection(card) {
                                let section = card.querySelector('[data-screenshot-section]');
                                if (section) return section;

                                section = document.createElement('div');
                                section.dataset.screenshotSection = '1';
                                section.className = 'mt-2';
                                section.innerHTML = `
                                        <div class="text-xs font-semibold text-slate-700">Screenshot</div>
                                        <a data-ss-link class="text-sm text-blue-600 underline" target="_blank" rel="noopener noreferrer" href="#">Not linked</a>
                                        <img data-ss-img class="mt-2 w-full max-h-40 object-cover rounded-lg border border-slate-200 cursor-pointer" alt="Screenshot preview" hidden />
                                        <div data-ss-picker class="mt-2 flex gap-2 items-center" hidden>
                                            <input data-ss-input class="flex-1 rounded-lg border border-slate-300 bg-white px-2 py-1 text-sm" list="screenshotOptions" placeholder="Choose screenshot path (e.g. screenshots/site/auth/auth_password_new.png)" />
                                            <button type="button" data-ss-set class="rounded-lg border border-slate-300 bg-white px-3 py-1 text-sm hover:bg-slate-50">Set</button>
                                        </div>
                                `;

                // Place it before details toggle if present (keeps it near status)
                const toggle = card.querySelector('[data-details-toggle]');
                if (toggle) {
                    card.insertBefore(section, toggle);
                } else {
                    const meta = card.querySelector('[data-meta-row]');
                    if (meta) card.insertBefore(section, meta);
                    else card.appendChild(section);
                }

                return section;
            }

            function renderCardScreenshot(card) {
                const section = ensureScreenshotSection(card);
                const link = section.querySelector('[data-ss-link]');
                const img = section.querySelector('[data-ss-img]');
                const picker = section.querySelector('[data-ss-picker]');
                const input = section.querySelector('[data-ss-input]');

                const path = card.dataset.screenshotPath || '';
                if (input) input.value = path;

                if (path) {
                    link.textContent = 'Open screenshot';
                    link.href = path;
                    img.src = path;
                    img.hidden = false;
                    img.onclick = () => window.open(path, '_blank', 'noopener');
                } else {
                    link.textContent = 'Not linked';
                    link.href = '#';
                    img.hidden = true;
                    img.src = '';
                }

                // picker visible only while editing
                if (picker) picker.hidden = !card.classList.contains('editing');
            }

            function applyChecklistItem(li, item) {
                // item: { text, done }
                const checkbox = li.querySelector('input[type="checkbox"]');
                const label = li.querySelector('span[data-check-text]');
                if (checkbox) checkbox.checked = !!item.done;
                if (label) label.textContent = item.text || '';
                if (item.done) {
                    label.classList.add('line-through', 'text-slate-400');
                } else {
                    label.classList.remove('line-through', 'text-slate-400');
                }
            }

            function ensureDetailsSection(card) {
                let title = card.querySelector('[data-details-title]');
                let list = card.querySelector('[data-details-list]');
                let wrap = card.querySelector('[data-details-wrap]');
                let toggle = card.querySelector('[data-details-toggle]');
                if (title && list && wrap && toggle) return { title, list, wrap, toggle };

                wrap = document.createElement('div');
                wrap.dataset.detailsWrap = '1';
                wrap.className = 'mt-1';

                title = document.createElement('div');
                title.dataset.detailsTitle = '1';
                title.className = 'mt-2 text-xs font-semibold text-slate-700';
                title.textContent = 'Sub-tasks';

                list = document.createElement('ul');
                list.dataset.detailsList = '1';
                list.className = 'mt-1 space-y-1 text-sm text-slate-600';

                for (let i = 0; i < 8; i += 1) {
                    const li = document.createElement('li');
                    li.className = 'flex items-start gap-2';

                    const cb = document.createElement('input');
                    cb.type = 'checkbox';
                    cb.className = 'mt-1';

                    const span = document.createElement('span');
                    span.dataset.checkText = '1';
                    span.className = 'flex-1';
                    span.textContent = '';

                    // Make label editable when card is in editing state
                    span.contentEditable = 'false';
                    span.classList.add('editable');

                    cb.addEventListener('change', () => {
                        applyChecklistItem(li, { text: span.textContent.trim(), done: cb.checked });
                        saveBoardState();
                    });

                    span.addEventListener('focusin', () => {
                        if (!card.classList.contains('editing')) return;
                    });

                    span.addEventListener('focusout', () => {
                        saveBoardState();
                    });

                    li.appendChild(cb);
                    li.appendChild(span);
                    list.appendChild(li);
                }

                toggle = document.createElement('button');
                toggle.type = 'button';
                toggle.dataset.detailsToggle = '1';
                toggle.className = 'mt-2 text-xs font-semibold text-slate-700 underline hover:text-slate-900';
                toggle.textContent = 'Hide details';

                const controlsId = `details-${card.dataset.featureId || Math.random().toString(36).slice(2)}`;
                wrap.id = controlsId;
                toggle.setAttribute('aria-controls', controlsId);
                toggle.setAttribute('aria-expanded', 'true');

                wrap.appendChild(title);
                wrap.appendChild(list);

                const meta = card.querySelector('[data-meta-row]');
                if (meta) {
                    card.insertBefore(wrap, meta);
                    card.insertBefore(toggle, wrap);
                } else {
                    card.appendChild(toggle);
                    card.appendChild(wrap);
                }

                return { title, list, wrap, toggle };
            }

            function getDetails(card) {
                const list = card.querySelector('[data-details-list]');
                if (!list) return [];
                return Array.from(list.querySelectorAll('li')).slice(0, 8).map(li => {
                    const cb = li.querySelector('input[type="checkbox"]');
                    const txt = li.querySelector('span[data-check-text]')?.textContent?.trim() || '';
                    return { text: txt, done: !!(cb && cb.checked) };
                }).filter(item => item.text || item.done);
            }

            function setDetails(card, details) {
                const { list } = ensureDetailsSection(card);
                const items = Array.from(list.querySelectorAll('li')).slice(0, 8);
                // Accept array of strings or array of {text,done}
                const vals = Array.isArray(details) ? details.slice(0, 8) : [];
                for (let i = 0; i < items.length; i += 1) {
                    const li = items[i];
                    const cb = li.querySelector('input[type="checkbox"]');
                    const span = li.querySelector('span[data-check-text]');
                    const v = vals[i] || '';
                    if (typeof v === 'string') {
                        span.textContent = v || '';
                        if (cb) cb.checked = false;
                    } else if (v && typeof v === 'object') {
                        span.textContent = v.text || '';
                        if (cb) cb.checked = !!v.done;
                    } else {
                        span.textContent = '';
                        if (cb) cb.checked = false;
                    }
                    applyChecklistItem(li, { text: span.textContent.trim(), done: !!(cb && cb.checked) });
                }
            }

            function cleanupEmptyChecklistItems(card) {
                const list = card.querySelector('[data-details-list]');
                if (!list) return;
                const items = Array.from(list.querySelectorAll('li'));
                items.forEach(li => {
                    const cb = li.querySelector('input[type="checkbox"]');
                    const txt = li.querySelector('span[data-check-text]')?.textContent?.trim() || '';
                    if (!txt && (!cb || !cb.checked)) {
                        li.remove();
                    }
                });
            }

            function applyDetailsVisibility(card, open) {
                const { wrap, toggle } = ensureDetailsSection(card);
                const isOpen = open !== false;
                card.dataset.detailsOpen = isOpen ? 'true' : 'false';
                wrap.hidden = !isOpen;
                toggle.textContent = isOpen ? 'Hide details' : 'Show details';
                toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
            }

            function renderCardTimestamps(card) {
                const meta = ensureMetaRow(card);
                const createdEl = meta.querySelector('[data-created]');
                const movedEl = meta.querySelector('[data-moved]');
                if (createdEl) createdEl.textContent = `Created: ${formatDateTime(card.dataset.createdAt)}`;
                if (movedEl) movedEl.textContent = `Moved: ${formatDateTime(card.dataset.movedAt)}`;
            }

            function safeText(str) {
                return (str || '').trim().toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9\-]/g, '');
            }

            function ensureCardIds() {
                const seen = new Set();
                cards.forEach((card, idx) => {
                    if (card.dataset.featureId) return;
                    const title = card.querySelector('h4')?.textContent || `feature-${idx}`;
                    let base = safeText(title) || `feature-${idx}`;
                    let candidate = base;
                    let n = 2;
                    while (seen.has(candidate)) {
                        candidate = `${base}-${n}`;
                        n += 1;
                    }
                    seen.add(candidate);
                    card.dataset.featureId = candidate;
                });
            }

            function setBadgeForColumn(card, columnKey) {
                const badge = card.querySelector('.status-badge');
                if (!badge) return;
                badge.classList.remove(
                    'bg-green-100', 'text-green-800',
                    'bg-yellow-100', 'text-yellow-800',
                    'bg-red-100', 'text-red-800'
                );

                if (columnKey === 'complete') {
                    badge.textContent = '‚úÖ Complete';
                    badge.classList.add('bg-green-100', 'text-green-800');
                } else if (columnKey === 'in_progress') {
                    badge.textContent = 'üü° Partial';
                    badge.classList.add('bg-yellow-100', 'text-yellow-800');
                } else {
                    badge.textContent = '‚ùå Missing';
                    badge.classList.add('bg-red-100', 'text-red-800');
                }
            }

            function updateCounts() {
                const completeCount = document.querySelectorAll('.kanban-column[data-column="complete"] .feature-card').length;
                const inProgressCount = document.querySelectorAll('.kanban-column[data-column="in_progress"] .feature-card').length;
                const missingCount = document.querySelectorAll('.kanban-column[data-column="missing"] .feature-card').length;
                const total = completeCount + inProgressCount + missingCount;

                const pct = total === 0 ? 0 : Math.round((completeCount / total) * 100);

                const elCountComplete = document.getElementById('countComplete');
                const elCountInProgress = document.getElementById('countInProgress');
                const elCountMissing = document.getElementById('countMissing');
                const elStatCompletePercent = document.getElementById('statCompletePercent');
                const elStatInProgress = document.getElementById('statInProgress');
                const elStatMissing = document.getElementById('statMissing');
                const elStatTotal = document.getElementById('statTotal');

                if (elCountComplete) elCountComplete.textContent = String(completeCount);
                if (elCountInProgress) elCountInProgress.textContent = String(inProgressCount);
                if (elCountMissing) elCountMissing.textContent = String(missingCount);

                if (elStatCompletePercent) elStatCompletePercent.textContent = `${pct}%`;
                if (elStatInProgress) elStatInProgress.textContent = String(inProgressCount);
                if (elStatMissing) elStatMissing.textContent = String(missingCount);
                if (elStatTotal) elStatTotal.textContent = String(total);
            }

            function saveBoardState() {
                const state = {};
                columns.forEach(col => {
                    const colKey = col.dataset.column;
                    Array.from(col.querySelectorAll('.feature-card')).forEach(card => {
                        const title = card.querySelector('h4')?.textContent?.trim() || '';
                        const desc = card.querySelector('p')?.textContent?.trim() || '';
                        const details = getDetails(card);
                        state[card.dataset.featureId] = {
                            column: colKey,
                            title,
                            desc,
                            details,
                            screenshotPath: card.dataset.screenshotPath || null,
                            detailsOpen: card.dataset.detailsOpen === 'false' ? false : true,
                            createdAt: card.dataset.createdAt || null,
                            movedAt: card.dataset.movedAt || null
                        };
                    });
                });
                try {
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
                } catch (_) {
                    // ignore storage errors (private mode, quota, etc.)
                }
            }

            function restoreBoardState() {
                let state = null;
                try {
                    state = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null');
                } catch (_) {
                    state = null;
                }
                if (!state || typeof state !== 'object') return;

                const cardById = new Map(cards.map(c => [c.dataset.featureId, c]));
                const columnByKey = new Map(columns.map(c => [c.dataset.column, c]));

                Object.entries(state).forEach(([id, value]) => {
                    const card = cardById.get(id);
                    if (!card) return;

                    // Backward compatibility: older format stored {id: "column"}
                    const colKey = typeof value === 'string' ? value : value?.column;
                    const col = columnByKey.get(colKey);
                    if (col) {
                        col.appendChild(card);
                        setBadgeForColumn(card, colKey);
                    }

                    if (value && typeof value === 'object') {
                        const titleEl = card.querySelector('h4');
                        const descEl = card.querySelector('p');
                        if (titleEl && typeof value.title === 'string') titleEl.textContent = value.title;
                        if (descEl && typeof value.desc === 'string') descEl.textContent = value.desc;

                        if (Array.isArray(value.details)) setDetails(card, value.details);
                        if (typeof value.detailsOpen === 'boolean') applyDetailsVisibility(card, value.detailsOpen);

                        if (typeof value.screenshotPath === 'string' && value.screenshotPath) {
                            card.dataset.screenshotPath = value.screenshotPath;
                        }

                        if (typeof value.createdAt === 'string' && value.createdAt) card.dataset.createdAt = value.createdAt;
                        if (typeof value.movedAt === 'string' && value.movedAt) card.dataset.movedAt = value.movedAt;
                    }
                });
            }

            function bootstrapMissingState() {
                // Ensure every card has a createdAt and meta row even before any drag/edit.
                const nowIso = new Date().toISOString();
                let state = null;
                try {
                    state = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null');
                } catch (_) {
                    state = null;
                }
                if (!state || typeof state !== 'object') state = {};

                let changed = false;
                cards.forEach(card => {
                    ensureMetaRow(card);
                    const stored = state?.[card.dataset.featureId];
                    ensureDetailsSection(card);
                    ensureScreenshotSection(card);
                    if (!card.dataset.createdAt) {
                        // Prefer stored value if present; otherwise initialize.
                        if (stored && typeof stored === 'object' && typeof stored.createdAt === 'string' && stored.createdAt) {
                            card.dataset.createdAt = stored.createdAt;
                        } else {
                            card.dataset.createdAt = nowIso;
                            changed = true;
                        }
                    }
                    if (!card.dataset.movedAt) {
                        if (stored && typeof stored === 'object' && typeof stored.movedAt === 'string' && stored.movedAt) {
                            card.dataset.movedAt = stored.movedAt;
                        }
                    }

                    // Default details visibility: open unless stored otherwise
                    if (stored && typeof stored === 'object' && typeof stored.detailsOpen === 'boolean') {
                        applyDetailsVisibility(card, stored.detailsOpen);
                    } else {
                        applyDetailsVisibility(card, true);
                    }

                    renderCardTimestamps(card);
                    renderCardScreenshot(card);
                });

                if (changed) saveBoardState();
            }

            ensureCardIds();

            // Drag + drop
            cards.forEach(card => {
                card.draggable = true;

                // Tailwind-only interactivity (no external CSS)
                card.classList.add('transition', 'duration-200', 'transform', 'hover:-translate-y-0.5', 'hover:shadow-xl', 'cursor-grab', 'select-none');

                // Make title/desc editable on demand
                const titleEl = card.querySelector('h4');
                const descEl = card.querySelector('p');
                if (titleEl) titleEl.classList.add('editable');
                if (descEl) descEl.classList.add('editable');
                const detailsSection = ensureDetailsSection(card);
                const detailsList = detailsSection.list;
                const detailItems = Array.from(detailsList.querySelectorAll('li')).slice(0, 5);

                const screenshotSection = ensureScreenshotSection(card);
                const shotInput = screenshotSection.querySelector('[data-ss-input]');
                const shotSet = screenshotSection.querySelector('[data-ss-set]');

                if (shotSet && shotInput) {
                    shotSet.addEventListener('click', () => {
                        const val = (shotInput.value || '').trim();
                        card.dataset.screenshotPath = val;
                        renderCardScreenshot(card);
                        saveBoardState();
                    });
                }

                // Toggle details
                detailsSection.toggle.addEventListener('click', () => {
                    const open = card.dataset.detailsOpen === 'false';
                    applyDetailsVisibility(card, open);
                    saveBoardState();
                });

                function enableEditing() {
                    card.classList.add('editing');
                    card.classList.add('ring-2', 'ring-blue-300', 'ring-offset-2');
                    card.classList.remove('cursor-grab');
                    card.draggable = false;
                    // Always expand while editing so bullets are accessible
                    applyDetailsVisibility(card, true);
                    if (titleEl) {
                        titleEl.contentEditable = 'true';
                        titleEl.setAttribute('role', 'textbox');
                    }
                    if (descEl) {
                        descEl.contentEditable = 'true';
                        descEl.setAttribute('role', 'textbox');
                    }
                    detailItems.forEach(li => {
                        li.contentEditable = 'true';
                        li.setAttribute('role', 'textbox');
                    });

                    // Show screenshot picker while editing
                    renderCardScreenshot(card);
                    // focus title first
                    if (titleEl) {
                        const range = document.createRange();
                        range.selectNodeContents(titleEl);
                        const sel = window.getSelection();
                        sel.removeAllRanges();
                        sel.addRange(range);
                        titleEl.focus();
                    }
                }

                function disableEditing(save) {
                    card.classList.remove('editing');
                    card.classList.remove('ring-2', 'ring-blue-300', 'ring-offset-2');
                    card.classList.add('cursor-grab');
                    if (titleEl) titleEl.contentEditable = 'false';
                    if (descEl) descEl.contentEditable = 'false';
                    detailItems.forEach(li => (li.contentEditable = 'false'));
                    card.draggable = true;
                    if (save) {
                        saveBoardState();
                    }

                    // Hide screenshot picker
                    renderCardScreenshot(card);
                }

                // Double-click anywhere on the card to edit
                card.addEventListener('dblclick', (e) => {
                    // Avoid triggering edit while dragging
                    if (card.classList.contains('dragging')) return;
                    enableEditing();
                    e.preventDefault();
                });

                // Save on blur (when leaving the card)
                card.addEventListener('focusout', () => {
                    if (!card.classList.contains('editing')) return;
                    // give focus a tick to move between title/desc without exiting edit mode
                    window.setTimeout(() => {
                        const active = document.activeElement;
                        if (card.contains(active)) return;
                        disableEditing(true);
                        renderCardTimestamps(card);
                    }, 0);
                });

                // ESC cancels editing (reverts by reloading from storage snapshot)
                card.addEventListener('keydown', (e) => {
                    if (!card.classList.contains('editing')) return;
                    if (e.key === 'Escape') {
                        e.preventDefault();
                        // restore from saved state
                        restoreBoardState();
                        updateCounts();
                        disableEditing(false);
                    }
                    // prevent Enter from creating new lines in the title
                    if (e.key === 'Enter' && document.activeElement === titleEl) {
                        e.preventDefault();
                        if (descEl) descEl.focus();
                    }
                });

                card.addEventListener('dragstart', (e) => {
                    if (card.classList.contains('editing')) {
                        e.preventDefault();
                        return;
                    }
                    card.classList.add('dragging');
                    card.classList.add('opacity-50', 'cursor-grabbing');
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', card.dataset.featureId);
                });

                card.addEventListener('dragend', () => {
                    card.classList.remove('dragging');
                    card.classList.remove('opacity-50', 'cursor-grabbing');
                    columns.forEach(c => {
                        c.classList.remove('drop-target', 'outline', 'outline-2', 'outline-dashed', 'outline-slate-400', 'outline-offset-4');
                    });
                });
            });

            columns.forEach(col => {
                col.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                    col.classList.add('drop-target');
                    col.classList.add('outline', 'outline-2', 'outline-dashed', 'outline-slate-400', 'outline-offset-4');
                });

                col.addEventListener('dragleave', () => {
                    col.classList.remove('drop-target');
                    col.classList.remove('outline', 'outline-2', 'outline-dashed', 'outline-slate-400', 'outline-offset-4');
                });

                col.addEventListener('drop', (e) => {
                    e.preventDefault();
                    col.classList.remove('drop-target');
                    col.classList.remove('outline', 'outline-2', 'outline-dashed', 'outline-slate-400', 'outline-offset-4');
                    const id = e.dataTransfer.getData('text/plain');
                    const dragged = document.querySelector(`.feature-card[data-feature-id="${CSS.escape(id)}"]`);
                    if (!dragged) return;

                    col.appendChild(dragged);
                    setBadgeForColumn(dragged, col.dataset.column);
                    dragged.dataset.movedAt = new Date().toISOString();
                    renderCardTimestamps(dragged);
                    updateCounts();
                    saveBoardState();
                });
            });

            restoreBoardState();
            bootstrapMissingState();
            // Seed checklist subtasks when missing using provided founder backlog
            (function seedFoundersChecklistIfMissing() {
                const seeds = new Map();
                // Map keys are normalized (safeText) titles
                seeds.set(safeText('Founder Email + Password Registration & Authentication'), [
                    { text: 'Create registration form (email, password, confirm password, first/last name)', done: false },
                    { text: 'Enforce strong password rules', done: false },
                    { text: 'Hash passwords securely', done: false },
                    { text: 'Check email uniqueness', done: false },
                    { text: 'Rate limiting & security headers', done: false },
                    { text: 'Unit tests for auth flow', done: false }
                ]);
                seeds.set(safeText('Founder Forgot/Reset Password Flow'), [
                    { text: '"Forgot password" link on login', done: false },
                    { text: 'Send time-limited reset token via email', done: false },
                    { text: 'Reset password form with confirmation', done: false },
                    { text: 'Update password & invalidate old sessions', done: false },
                    { text: 'Email templates & success/error handling', done: false }
                ]);
                seeds.set(safeText('Email Confirmation / Account Activation'), [
                    { text: 'Generate & send verification token on sign-up', done: false },
                    { text: 'Verification endpoint (click link)', done: false },
                    { text: 'Block access until verified', done: false },
                    { text: 'Resend verification option', done: false },
                    { text: 'Handle expired/invalid tokens', done: false }
                ]);
                seeds.set(safeText('Founder Onboarding Wizard ‚Äì Multi-step Profile Setup'), [
                    { text: 'Wizard layout with step sidebar & progress bar', done: false },
                    { text: 'Steps: Personal Info, Startup Details, Professional Background, Privacy, Review', done: false },
                    { text: 'Save draft on each step', done: false },
                    { text: '"Save & Exit" functionality', done: false }
                ]);
                seeds.set(safeText('Founder Profile Fields in Onboarding'), [
                    { text: 'Personal: photo upload, bio, location', done: false },
                    { text: 'Startup: name, logo, focus area, description, website/social links', done: false },
                    { text: 'Professional: sector, stage, funding round', done: false },
                    { text: 'Privacy toggles (public/private per field)', done: false },
                    { text: 'Real-time validation & error messages', done: false }
                ]);
                seeds.set(safeText('Founder Dashboard ‚Äì Layout & Navigation'), [
                    { text: 'Dashboard layout (top bar + left sidebar + main area)', done: false },
                    { text: 'Left nav: Home, Startup Profile, Progress Tracker, Mentorship, Resources, Messages, Opportunities, Community, Account Settings, Support, Log Out', done: false },
                    { text: 'Responsive mobile menu', done: false },
                    { text: 'Personalized welcome banner', done: false }
                ]);
                seeds.set(safeText('Dashboard ‚Äì Top Navigation Bar'), [
                    { text: 'Profile picture avatar dropdown', done: false },
                    { text: 'Notification bell icon with badge counter', done: false },
                    { text: 'Responsive placement', done: false }
                ]);
                seeds.set(safeText('Startup Profile Summary & Edit View'), [
                    { text: 'Profile page showing all fields', done: false },
                    { text: 'Edit mode with forms mirroring onboarding', done: false },
                    { text: 'Team member add/remove (optional)', done: false },
                    { text: 'Save & preview changes', done: false }
                ]);
                seeds.set(safeText('Progress Tracking ‚Äì Milestones View'), [
                    { text: 'Milestones list/timeline view', done: false },
                    { text: 'Add new milestone form', done: false },
                    { text: 'Edit/delete existing milestones', done: false },
                    { text: 'Status tags (planned, in-progress, achieved)', done: false }
                ]);
                seeds.set(safeText('Progress Tracking ‚Äì Monthly Tracker Form'), [
                    { text: 'Form for Revenue, Customers, Runway, Burn Rate', done: false },
                    { text: 'Historical data storage', done: false },
                    { text: 'Validation & auto-calculation', done: false },
                    { text: 'Save & confirmation', done: false }
                ]);
                seeds.set(safeText('Dashboard ‚Äì Monthly Progress Charts'), [
                    { text: 'Line/area charts for key metrics', done: false },
                    { text: 'Pull data from monthly tracker', done: false },
                    { text: 'Responsive & interactive', done: false },
                    { text: 'Empty state handling & loading indicators', done: false }
                ]);
                seeds.set(safeText('Mentorship ‚Äì Recommended Mentors Display'), [
                    { text: '"Recommended Mentors" section', done: false },
                    { text: 'Query matching mentors', done: false },
                    { text: 'Cards with name, photo, expertise, match score', done: false }
                ]);
                seeds.set(safeText('Mentorship ‚Äì View Mentor Profile & Request'), [
                    { text: 'Mentor profile modal/page', done: false },
                    { text: '"Request Mentorship" button', done: false },
                    { text: 'Request form (message, preferred topics)', done: false }
                ]);
                seeds.set(safeText('Mentorship ‚Äì Session Booking Flow'), [
                    { text: 'Notification on mentor acceptance', done: false },
                    { text: 'Calendar view of mentor availability', done: false },
                    { text: 'Time slot picker', done: false },
                    { text: 'Confirmation + calendar sync', done: false }
                ]);
                seeds.set(safeText('Mentorship ‚Äì Upcoming/Booked Sessions Display'), [
                    { text: 'Sessions list/card view', done: false },
                    { text: 'Status indicators (upcoming, past)', done: false },
                    { text: 'Cancel/reschedule options', done: false }
                ]);
                seeds.set(safeText('Notification System ‚Äì Bell Icon Functionality'), [
                    { text: 'Notification dropdown/list', done: false },
                    { text: 'Types: request updates, new messages, opportunities', done: false },
                    { text: 'Mark as read & badge counter', done: false },
                    { text: 'Preference to turn off specific notification types', done: false }
                ]);
                seeds.set(safeText('Community ‚Äì Recommended Peers Display'), [
                    { text: '"Recommended Founders" section', done: false },
                    { text: 'Match by stage, industry, location', done: false },
                    { text: 'Peer cards with startup/logo', done: false }
                ]);
                seeds.set(safeText('Community ‚Äì Peer Messaging / Connect'), [
                    { text: '"Connect" or "Message" button on peer card', done: false },
                    { text: 'Open chat window', done: false },
                    { text: 'Send/receive messages', done: false }
                ]);
                seeds.set(safeText('In-Platform Messaging Center (Founder View)'), [
                    { text: 'Inbox with conversation threads', done: false },
                    { text: 'Real-time send/receive', done: false },
                    { text: 'Notification badges', done: false }
                ]);
                seeds.set(safeText('Resources ‚Äì Library View & Search/Filter'), [
                    { text: 'Resource grid/list', done: false },
                    { text: 'Keyword search bar', done: false },
                    { text: 'Category filters', done: false },
                    { text: 'Pagination / infinite scroll support', done: false },
                    { text: 'Recently viewed or favorites section', done: false }
                ]);
                seeds.set(safeText('Resources ‚Äì Rating & Interaction'), [
                    { text: 'Star rating system per resource', done: false },
                    { text: 'View average rating', done: false },
                    { text: 'Download/preview buttons', done: false }
                ]);
                seeds.set(safeText('Opportunities ‚Äì Curated List & Search'), [
                    { text: 'Opportunities grid', done: false },
                    { text: 'Type filter (grants, competitions, events)', done: false },
                    { text: 'Cards with title, organizer, desc, deadline', done: false },
                    { text: 'Deadline countdown badge', done: false },
                    { text: '"Save for later" functionality', done: false }
                ]);
                seeds.set(safeText('Account Settings ‚Äì Profile Updates & Password Change'), [
                    { text: 'Edit founder/startup info', done: false },
                    { text: 'Change password form', done: false },
                    { text: 'Privacy/visibility controls', done: false }
                ]);
                seeds.set(safeText('Account Settings ‚Äì Deactivate/Delete Account'), [
                    { text: 'Deactivation option (hide profile)', done: false },
                    { text: 'Offer data export before deactivation', done: false },
                    { text: 'Send confirmation email before final deletion', done: false },
                    { text: 'Final deletion endpoint with secure confirmation', done: false }
                ]);
                seeds.set(safeText('Support ‚Äì Help & Contact Section'), [
                    { text: 'FAQs accordion/list', done: false },
                    { text: 'Contact form or email link', done: false },
                    { text: 'Live chat integration (if available)', done: false }
                ]);
                seeds.set(safeText('Secure Logout Functionality'), [
                    { text: 'Logout endpoint (clear session/token)', done: false },
                    { text: 'Redirect to landing page', done: false },
                    { text: 'Confirmation toast', done: false }
                ]);


                // helper: produce token set for fuzzy matching
                function tokenSet(s) {
                    return new Set((s || '').toLowerCase().split(/[^a-z0-9]+/).filter(t => t.length > 2));
                }

                let changed = false;
                cards.forEach(card => {
                    const details = getDetails(card);
                    if (details && details.length > 0) return; // already has subtasks
                    const title = card.querySelector('h4')?.textContent || '';
                    const key = safeText(title);

                    if (seeds.has(key)) {
                        setDetails(card, seeds.get(key));
                        changed = true;
                        return;
                    }

                    // Fuzzy fallback: pick seed with highest token overlap
                    const cardTokens = tokenSet(title);
                    let best = null;
                    let bestScore = 0;
                    for (const [seedKey, arr] of seeds.entries()) {
                        const seedTokens = tokenSet(seedKey.replace(/-/g,' '));
                        let score = 0;
                        seedTokens.forEach(t => { if (cardTokens.has(t)) score += 1; });
                        if (score > bestScore) {
                            bestScore = score;
                            best = arr;
                        }
                    }
                    if (best && bestScore >= 2) {
                        setDetails(card, best);
                        changed = true;
                    }
                });

                // Remove empty checkbox lines left over after seeding
                cards.forEach(card => cleanupEmptyChecklistItems(card));

                if (changed) saveBoardState();
            })();
            updateCounts();

            // Load screenshot options (used for linking cards to screenshots)
            fetch('screenshots_index.json')
                .then(r => r.json())
                .then(list => {
                    if (Array.isArray(list)) screenshotPaths = list;
                    updateScreenshotDatalist();

                    // Auto-suggest screenshot for cards that aren't linked yet
                    cards.forEach(card => {
                        if (card.dataset.screenshotPath) return;
                        const title = card.querySelector('h4')?.textContent || '';
                        const suggestion = suggestScreenshotForTitle(title);
                        if (!suggestion) return;
                        card.dataset.screenshotPath = suggestion;
                        renderCardScreenshot(card);
                    });
                    saveBoardState();
                })
                .catch(() => {
                    // ignore; screenshot linking still works if manually typed
                });

        });
    </script>
</body>
</html>